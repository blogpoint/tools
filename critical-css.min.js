function reset_download_links(){$(".css-download-btns").find("a").each(function(a){var b=$(this).attr("href"),c=$(this).attr("download");void 0!==b&&(nl=b.replace(window.nf+"/css/"+window.domeniu,"folder/"),$(this).attr("href",nl),ndom=c.replace(window.domeniu,"dom/"),$(this).attr("download",ndom))})}function update_download_links(a){$(".css-download-btns").find("a").each(function(a){var b=$(this).attr("href"),c=$(this).attr("download");void 0!==b&&(nl=b.replace(/folder\//g,window.nf+"/css/"+window.domeniu),$(this).attr("href",nl),ndom=c.replace(/dom\//g,window.domeniu),$(this).attr("download",ndom))})}function stopTask(){es.close(),addLog("Interrupted")}function showMessage(a){$("#website-check-content strong").html(a)}function getResult(){reset_download_links(),$("#generated-css-content").hide(),$("#critical-css-textarea").html(""),cD.show(),$.ajax({url:"https://www.sitelocity.com/critical-css-data/generate.php",data:{url:$("#url").val()},type:"POST",xhrFields:{onprogress:function(a){var b=a.target.responseText.split("\n");res=JSON.parse(b.pop()),"0"==res.progress?showMessage(res.message):(res.data&&($("#critical-css-textarea").html(res.data.critical_css),$("#generated-css-content").show(),window.domeniu=res.data.domain,window.nf="/critical-css-data/processed/"+res.data.folder,update_download_links(res.data.domain)),showMessage(res.message),$(".generate-css-btn").find("button").prop("disabled",!1),cD.fadeOut(2e3).hide(2e3))}},success:function(a){}})}function startGen(){es=new EventSource("critical-css-data/index.php"),es.addEventListener("message",function(a){var b=JSON.parse(a.data);if(addLog(b.message),"CLOSE"==a.lastEventId){addLog("Received CLOSE closing"),es.close();var c=document.getElementById("progressor");c.value=c.max}else{var c=document.getElementById("progressor");c.value=b.progress;var d=document.getElementById("percentage");d.innerHTML=b.progress+"%",d.style.width=Math.floor(c.clientWidth*(b.progress/100))+15+"px"}}),es.addEventListener("open",function(a){},!1),es.addEventListener("error",function(a){addLog("Error occurred e="+JSON.stringify(a)),es.close()})}domeniu="y",nf="nf",$(".generate-css-btn").click(function(){cD=$("#website-check-wrapper"),"undefined"!=typeof pwt&&$(".please-wait").html(pwt),$(".generate-css-btn").find("button").prop("disabled",!0),cD.addClass("left-0"),setTimeout(function(){cD.addClass("visible")},20),cD.html(),type=$(this).data("type"),getResult()}),$(".reset").click(function(a){reset_download_links()}),$(".generate-css-btn1").click(function(){startGen(),eeeew,cD=$("#website-check-wrapper"),"undefined"!=typeof pwt&&$(".please-wait").html(pwt),$(".generate-css-btn").find("button").prop("disabled",!0),cD.addClass("left-0"),setTimeout(function(){cD.addClass("visible")},20),cD.html(),type=$(this).data("type"),$.post("data/index.php",{url:$("#url").val(),type:$(this).data("type")}).done(function(a){return a=JSON.parse(a),1==a.err?($(".generate-css-btn").find("button").prop("disabled",!1),pwt=$(".please-wait").html(),$(".please-wait").html(a.err_msg),!1):(cD.addClass("show-top"),setTimeout(function(){$("footer").hide(),$("#control-wrapper, #bg-wrapper").remove(),cD.fadeOut(400).remove()},800),setTimeout(function(){$("#website-results-data").html(a.content),$("#website-results-data").hide().fadeIn(1e3),count_to($(".ttfb"),a.ttfb,"s"),count_to($(".nrr"),a.nr_resources,""),count_to($(".lt"),a.lt,"s"),$("footer").show(),$("#check-new-website").show(),w=$("#screenshot").width(),h=$("#screenshot").height(),"mobile"==type&&($("body .nexus5").height(h-100),$("body .nexus5").css("width",(h-100)/1.65),$("body .nexus5").css("height",h-100),$("body .nexus5").hide(),$("body .nexus5").fadeIn(2e3))},800),void 0)})});
  
